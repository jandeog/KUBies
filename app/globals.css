/* =========================================================
   Theme tokens
   ========================================================= */
:root {
  --bg:    #ffffff;
  --fg:    #111111;
  --muted: #666;
  --card:  #f7f7f8;
  --border:#e5e7eb;

  /* Site Explorer accent */
  --accent:       #0a7f24;
  --accent-ink:   #ffffff;
  --accent-tint:  rgba(10,127,36,.12);
}

:root.dark {
  --bg:    #0b0b0d;
  --fg:    #e7e7ea;
  --muted: #a1a1aa;
  --card:  #111215;
  --border:#26272b;

  --accent:      #0a7f24;
  --accent-ink:  #ffffff;
  --accent-tint: rgba(10,127,36,.14);
}

/* Respect system dark if user hasn't forced .light */
@media (prefers-color-scheme: dark) {
  :root:not(.light) {
    color-scheme: dark;
    --bg:#0b0b0d; --fg:#e7e7ea; --muted:#a1a1aa; --card:#111215; --border:#26272b;
  }
}

/* =========================================================
   Base
   ========================================================= */
*{box-sizing:border-box}
html,body{margin:0;padding:0;background:var(--bg);color:var(--fg)}
a{color:inherit;text-decoration:none}

button{
  padding:10px 14px;border-radius:10px;border:1px solid var(--border);
  background:transparent;color:var(--fg);cursor:pointer;
}
input,textarea,select{
  width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);
  background:transparent;color:var(--fg)
}
label{font-weight:600;display:block;margin-top:8px;color:var(--fg)}
.grid{display:grid;gap:10px}

/* =========================================================
   Header / Layout
   ========================================================= */
.header{position:relative;display:flex;justify-content:space-between;align-items:center;gap:8px;padding:8px 0}
.brand{font-size:20px;margin:0}

/* Dropdown menu container used by HeaderClient */
.menu{
  display:none;               /* hidden by default */
  position:absolute; right:12px; top:56px; min-width:220px; padding:8px;
  border:1px solid var(--border); background:var(--card); border-radius:14px; z-index:1000;
  box-shadow:0 6px 24px rgba(0,0,0,.15);
}
.menu a,.menu button{
  display:block;width:100%;text-align:left;padding:10px 12px;border-radius:10px;border:none;background:transparent
}
.menu a:hover,.menu button:hover{background:rgba(127,127,127,.12)}

/* Show the dropdown when header toggles these flags (supports multiple approaches) */
.header[data-open="true"] .menu,
.menu.open{display:block}

/* =========================================================
   Subbie/Supplier compact rows
   ========================================================= */
.partner-row{
  position:relative;overflow:visible;
  display:flex;align-items:center;justify-content:space-between;
  border:1px solid var(--border);border-radius:12px;background:var(--card);
  padding:10px 14px;transition:background .2s,border-color .2s,box-shadow .2s
}
.partner-row:hover,.partner-row:focus-within{
  background:var(--accent-tint);
  border-color:var(--accent);
  z-index:999; /* keep flyouts over next slot */
}

.partner-left{flex:1;min-width:0;overflow:hidden}
.partner-company{font-weight:600;color:var(--fg);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:420px}
.partner-name{font-size:.875rem;color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:320px}

.partner-actions{display:flex;align-items:center;gap:6px;flex-shrink:0}

/* Icon button – neutral & compact (ignores global button rules) */
.action-btn{
  all:unset;display:inline-flex;align-items:center;justify-content:center;
  width:36px;height:28px;border-radius:10px;border:1px solid var(--border);
  background:rgba(255,255,255,.02);color:var(--fg);cursor:pointer
}
.action-btn:hover{background:var(--accent);border-color:var(--accent);color:var(--accent-ink)}

/* Disabled state (no hover, no pointer, no popup) */
.action-btn[aria-disabled="true"]{
  opacity:.35;cursor:default;pointer-events:none;
  background:rgba(255,255,255,.02);border-color:var(--border);color:var(--fg)
}

/* Flyouts */
.partner-menu{position:relative;display:inline-flex}
.partner-flyout{
  display:none;position:absolute;right:0;top:calc(100% + 4px);min-width:160px;
  background:var(--card);border:1px solid var(--border);border-radius:10px;
  box-shadow:0 10px 30px rgba(0,0,0,.25);z-index:9999;padding:6px;
  flex-direction:column;gap:4px;opacity:0;transform:translateY(-2px);
  transition:opacity .15s ease,transform .15s ease
}
/* keep open when moving icon → menu and when hovering menu itself */
.partner-menu:hover .partner-flyout,
.partner-flyout:hover{display:flex;opacity:1;transform:translateY(0)}
.partner-flyout::before{content:"";position:absolute;right:0;top:-6px;height:6px;width:100%;background:transparent}
.partner-flyout button{
  all:unset;padding:6px 10px;border-radius:8px;color:var(--fg);cursor:pointer;
  white-space:nowrap;overflow:hidden;text-overflow:ellipsis
}
.partner-flyout button:hover{background:rgba(10,127,36,.25);color:#fff}
/* Theme-aware native <select> for the Specialty filter */
.select-theme {
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 10px 12px;
  appearance: auto;            /* keep native arrow */
}

/* Dark theme: black popup, white text */
:root.dark .select-theme {
  background-color: #0b0b0d;
  color: #ffe7e7ea;
  color-scheme: dark;
}
:root.dark .select-theme option,
:root.dark .select-theme optgroup {
  background-color: #0b0b0d;
  color: #ffe7e7ea;
}

/* Light / system-light: white popup, dark text */
:root.light .select-theme,
:root:not(.dark):not(.light) .select-theme {
  color: #ffe7e7ea;
  color: #0b0b0d;
  color-scheme: light;
}
:root.light .select-theme option,
:root.light .select-theme optgroup,
:root:not(.dark):not(.light) .select-theme option,
:root:not(.dark):not(.light) .select-theme optgroup {
  background-color: #ffe7e7ea;
  color: #0b0b0d;
}


/* Popup list items */
.select--dark option,
.select--dark optgroup {
  background-color: #0b0b0d !important;
  color:#ffe7e7ea !important;
}

/* Hint browsers to use dark UI chrome for the popup */
.select--dark { color-scheme: dark; }

/* Focus ring in your accent */
.select--dark:focus { outline: 2px solid var(--accent); outline-offset: 1px; }

/* Optional: darker scrollbar inside the popup on WebKit */
.select--dark::-webkit-scrollbar { width: 10px; }
.select--dark::-webkit-scrollbar-track { background: #000; }
.select--dark::-webkit-scrollbar-thumb { background: #1f1f1f; border-radius: 6px; }
.partners-list { margin-top: 8px; }

/* ===== Mobile tweaks (≤ 640px) ===== */
@media (max-width: 640px) {
  .partner-row { padding: 8px 10px; }
  .partner-company { max-width: 62vw; font-size: 0.95rem; }
  .partner-name { display: none; }            /* hide second line to save space */
  .partner-actions { gap: 4px; }
  .action-btn { width: 32px; height: 28px; }  /* smaller buttons */
  .partner-flyout { right: -2px; top: calc(100% + 3px); min-width: 150px; }
}
/* Default icon size for action buttons */
.action-icon { width: 18px; height: 18px; }

/* ===== Mobile tweaks (≤ 640px) ===== */
@media (max-width: 640px) {
  .partner-row { padding: 8px 10px; }

  /* keep TWO lines: company (line 1) + name (line 2), just smaller */
  .partner-company {
    font-size: 0.95rem;
    max-width: calc(100% - 130px);   /* leave room for buttons */
  }
  .partner-name {
    display: block;                   /* ensure second line shows */
    margin-top: 2px;
    font-size: 0.82rem;
    max-width: calc(100% - 130px);   /* same cap as company */
  }

  .partner-left { min-width: 0; }    /* allow truncation */

  /* buttons: good tap targets but still compact */
  .partner-actions { gap: 6px; }
  .action-btn      { width: 34px; height: 34px; }  /* taller for touch */
  .action-icon     { width: 16px; height: 16px; }  /* slightly smaller glyphs */

  /* flyout stays tight on mobile */
  .partner-flyout { right: -2px; top: calc(100% + 3px); min-width: 150px; }
}


